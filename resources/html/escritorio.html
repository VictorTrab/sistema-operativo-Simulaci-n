<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Ruben Quiroz">
    <title>Escritorio</title>
<!-- link a stylos css -->
    <link rel="stylesheet" href="/resources/css/styles.css">
    <link rel="stylesheet" href="/resources/css/windows.css">
    <link rel="stylesheet" href="/resources/css/template.css">
    <link rel="dns-prefetch" href="//unpkg.com" />
    <link rel="dns-prefetch" href="//cdn.jsdelivr.net" />
    <link rel="stylesheet" href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css">
</head>
<body>
    <main>
        <div class="bg-cover bg-center h-screen" style="background-image: url('/resources/assets/images/Fondo1.png');">
            <div class="barra-superior">
                <!-- Contenido de la barra superior -->
                <div class="botones flex justify-start items-center">
                    <button><img class="h-20 w-20" src="/resources/assets/images/probart.png" width="20"
                            height="20"></button>
                    <button class="text-2xl">Buscar</button>
                </div>
                <div class="botones flex align-center px-2">
                    <span class="hora_actual px-2 text-2xl">00:00</span>

                     <!--Iconos de estado wifi, sonido, bateria -->
                     <button class="px-2">
                        <img src="https://img.icons8.com/ios-filled/20/ffffff/wifi.png" alt="WiFi" class="w-5 h-5">
                    </button>
                    <button class="px-2">
                          <img src="https://img.icons8.com/ios-filled/20/ffffff/speaker.png" alt="Sonido" class="w-5 h-5">
                    </button>
                    <button class="px-2">
                        <img src="https://img.icons8.com/ios-filled/20/ffffff/battery--v1.png" alt="Bater√≠a" class="w-5 h-5">
                    </button>
                    <button class="px-2">
                        <svg xmlns="http://www.w3.org/2000/svg"
                            class="  icon icon-tabler icon-tabler-user-star" width="28" height="28" viewBox="0 0 24 24"
                            stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round"
                            stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                            <path d="M6 21v-2a4 4 0 0 1 4 -4h1"></path>
                            <path
                                d="M17.8 20.817l-2.172 1.138a.392 .392 0 0 1 -.568 -.41l.415 -2.411l-1.757 -1.707a.389 .389 0 0 1 .217 -.665l2.428 -.352l1.086 -2.193a.392 .392 0 0 1 .702 0l1.086 2.193l2.428 .352a.39 .39 0 0 1 .217 .665l-1.757 1.707l.414 2.41a.39 .39 0 0 1 -.567 .411l-2.172 -1.138z">
                            </path>
                            <path d="M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0"></path>
                        </svg>
                    </button>
                    <button class="px-2 rounded-none focus:outline-none" id="calendar">
                    <!-- para evitar que al dar click sostenido se redondee el bot√≥n de color negro -->
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="28" height="28" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                            <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
                            <path d="M18 18m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0" />
                            <path d="M15 3v4" />
                            <path d="M7 3v4" />
                            <path d="M3 11h16" />
                            <path d="M18 16.496v1.504l1 1" />
                          </svg>
                    </button>
                    <button class="cerrarSesion px-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-logout" width="28"
                            height="28" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none"
                            stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                            <path d="M14 8v-2a2 2 0 0 0 -2 -2h-7a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h7a2 2 0 0 0 2 -2v-2">
                            </path>
                            <path d="M7 12h14l-3 -3m0 6l3 -3"></path>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="flex justify-center">
                <div class="barra-tareas">
                    <button class="button-barra-tareas terminal">
                        <img src="/resources/assets/images/terminal-solid 1.png">
                    </button>
                    <button class="button-barra-tareas camara">
                        <img src="/resources/assets/images/camera-solid 1.png">
                    </button>
                    <button class="button-barra-tareas ed_texto">
                        <img src="/resources/assets/images/clipboard-regular 2.png">
                    </button>
                    <button class="button-barra-tareas video">
                        <img src="/resources/assets/images/video-solid 1.png">
                    </button>
                    <button class="button-barra-tareas calculator">
                        <img src="/resources/assets/images/calculator-solid 1.png">
                    </button>
                    <button class="button-barra-tareas paint gestor_tarea">
                       <img src="/resources/assets/images/test_tasks_list_clipboard_todo_icon_191634 1.png">
                    </button>
                        <button class="button-barra-tareas explorer-files">
                       <img src="/resources/assets/images/folder-regular 1.png">
                    </button>
                </div>
            </div>
        </div>
        <!-- calendario -->
        <div class="calendario w-8/12 fixed top-0 right-0 bg-opacity-50 bg-transparent hidden">
            <style>
                [x-cloak] {
                    display: none;
                }
            </style>
                <div class="w-full min-h-screen flex justify-end items-start p-8 mt-16">
                    <div class="w-11/12 md:w-8/12 bg-purple-700 bg-opacity-95 rounded-xl shadow-xl p-6" x-data="app()" x-init="[initDate(), getNoOfDays()]" x-cloak>
                        <div class="flex items-center justify-between mb-4 text-white">
                            <div>
                                <span x-text="MONTH_NAMES[month]" class="text-2xl font-bold"></span>
                                <span x-text="year" class="ml-2 text-xl"></span>
                            </div>
                            <div class="flex space-x-2 items-center">
                                <button @click="month--; getNoOfDays()" :disabled="month == 0" class="bg-white text-purple-700 p-2 rounded-full hover:bg-purple-200 disabled:opacity-50">
                                    <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                                    </svg>
                                </button>
                                <button @click="month++; getNoOfDays()" :disabled="month == 11" class="bg-white text-purple-700 p-2 rounded-full hover:bg-purple-200 disabled:opacity-50">
                                    <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                                    </svg>
                                </button>
                                <button @click="$el.closest('.calendario').classList.add('hidden')" class="text-white text-xl font-bold hover:text-purple-200">‚úï</button>
                            </div>
                        </div>

                        <div class="grid grid-cols-7 text-center text-white font-semibold">
                            <template x-for="(day, index) in DAYS" :key="index">
                                <div class="py-2" x-text="day"></div>
                            </template>
                        </div>

                        <div class="grid grid-cols-7 gap-2 mt-2">
                            <template x-for="blankday in blankdays">
                                <div></div>
                            </template>
                            <template x-for="(date, dateIndex) in no_of_days" :key="dateIndex">
                                <div class="bg-white rounded-lg p-2 text-purple-700 relative">
                                    <div @click="showEventModal(date)"
                                        class="cursor-pointer hover:bg-purple-100 rounded-full w-8 h-8 flex items-center justify-center text-sm font-bold mx-auto"
                                        :class="{ 'bg-purple-700 text-white': isToday(date) }" x-text="date">
                                    </div>
                                    <template x-for="event in events.filter(e => e.event_date === new Date(year, month, date).toISOString().split('T')[0])">
                                        <div class="mt-1 text-xs px-1 py-0.5 rounded bg-purple-200 text-purple-900 flex justify-between items-center">
                                            <span x-text="event.event_title" class="truncate"></span>
                                            <div class="ml-2">
                                                <button class="text-xs text-red-500 hover:underline" @click="removeEvent(event)">Eliminar</button>
                                                <button class="text-xs text-blue-500 hover:underline ml-1" @click="editEvent(event)">Editar</button>
                                            </div>
                                        </div>
                                    </template>
                                </div>
                            </template>
                        </div>
                        <!-- Modal -->
                        <!-- Calendario -->
                        <div x-show.transition.opacity="openEventModal" class="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50">
                            <div class="bg-white rounded-lg shadow-lg w-full max-w-md p-6">
                                <h2 class="text-2xl font-semibold text-purple-700 mb-4">Detalles del Evento</h2>

                                <label class="block mb-2 text-sm font-medium text-gray-700">T√≠tulo del evento</label>
                                <input x-model="event_title" class="w-full mb-4 p-2 border rounded" type="text">

                                <label class="block mb-2 text-sm font-medium text-gray-700">Fecha</label>
                                <input x-model="formatted_event_date" class="w-full mb-4 p-2 border rounded bg-gray-100" type="text" readonly>
                                <div class="text-right">
                                    <button @click="openEventModal = false" class="bg-gray-300 px-4 py-2 rounded mr-2">Cancelar</button>
                                    <button @click="addEvent()" class="bg-purple-700 text-white px-4 py-2 rounded">Guardar</button>
                                </div>
                            </div>
                        </div>  
                </div>
            </div>
        </div>
        <!-- Crear ventanas Mobales para diferentes App -->
        <div class="window" id="appWindow">
            <div class="title-bar" id="titleBar">
                <div class="title">
                    <div class="app-icon">üì±</div>
                    <span id="appTitle">Mi Aplicaci√≥n</span>
                </div>
                    <div class="window-controls">
                        <button class="control-btn minimize-btn" id="minimizeBtn"></button>
                        <button class="control-btn maximize-btn" id="maximizeBtn"></button>
                        <button class="control-btn close-btn" id="closeBtn"></button>
                    </div>
                </div>
        
                <div class="app-content" id="appContent">
                <!-- AQU√ç VA EL CONTENIDO DE TU APLICACI√ìN -->
  
                <!-- FIN DEL CONTENIDO DE EJEMPLO -->
                </div>
                <div class="resize-handle right"></div>
                <div class="resize-handle bottom"></div>
                <div class="resize-handle corner"></div>
            <button class="restore-btn" id="restoreBtn">‚ÜóÔ∏è</button>
        </div> 
     <!-- /funciones del calendario-->
        <script>
        const MONTH_NAMES = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];
        const DAYS = ['Dom', 'Lun', 'Mar', 'Mi√©', 'Jue', 'Vie', 'S√°b'];

        function app() {
            return {
                month: '',
                year: '',
                no_of_days: [],
                blankdays: [],
                days: DAYS,
                events: [],
                event_title: '',
                event_date: '',
                openEventModal: false,
                editMode: false,
                editingEventIndex: null,

                get formatted_event_date() {
                    return this.event_date ? new Date(this.event_date).toLocaleDateString('es-ES', {
                        weekday: 'long',
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric'
                    }) : '';
                },

                initDate() {
                    let today = new Date();
                    this.month = today.getMonth();
                    this.year = today.getFullYear();
                    this.getNoOfDays();
                    this.loadEvents();
                },

                isToday(date) {
                    const today = new Date();
                    const d = new Date(this.year, this.month, date);
                    return today.toDateString() === d.toDateString();
                },

                showEventModal(date) {
                    this.openEventModal = true;
                    this.event_date = new Date(this.year, this.month, date).toISOString().split('T')[0]; // formato ISO
                    this.event_title = '';
                    this.editMode = false;
                    this.editingEventIndex = null;
                },

                addEvent() {
                    if (!this.event_title) return;

                    if (this.editMode && this.editingEventIndex !== null) {
                        this.events[this.editingEventIndex].event_title = this.event_title;
                    } else {
                        this.events.push({
                            event_date: this.event_date,
                            event_title: this.event_title
                        });
                    }

                    this.saveEvents();
                    this.resetModal();
                },

                removeEvent(event) {
                    this.events = this.events.filter(e => e !== event);
                    this.saveEvents();
                },

                editEvent(event) {
                    this.event_title = event.event_title;
                    this.event_date = event.event_date;
                    this.editMode = true;
                    this.openEventModal = true;
                    this.editingEventIndex = this.events.indexOf(event);
                },

                getNoOfDays() {
                    let daysInMonth = new Date(this.year, this.month + 1, 0).getDate();
                    let dayOfWeek = new Date(this.year, this.month).getDay();
                    this.blankdays = Array.from({ length: dayOfWeek }, (_, i) => i);
                    this.no_of_days = Array.from({ length: daysInMonth }, (_, i) => i + 1);
                },

                saveEvents() {
                    localStorage.setItem('calendar-events', JSON.stringify(this.events));
                },

                loadEvents() {
                    const saved = localStorage.getItem('calendar-events');
                    if (saved) {
                        this.events = JSON.parse(saved);
                    }
                },

                resetModal() {
                    this.event_title = '';
                    this.event_date = '';
                    this.openEventModal = false;
                    this.editMode = false;
                    this.editingEventIndex = null;
                }
            }
        }
        </script>
    
        <!-- //mostrar autom√°ticamente un fondo personalizado (wallpaper) -->
        <script>
            document.addEventListener("DOMContentLoaded", function () {
            const wallpaper = localStorage.getItem("wallpaper");
            const bgCover = document.getElementsByClassName("bg-cover")[0];
            if (wallpaper && bgCover) {
                bgCover.style.backgroundImage = `url('${wallpaper}')`;
                bgCover.style.backgroundSize = "cover";
                bgCover.style.backgroundRepeat = "no-repeat";
                bgCover.style.backgroundPosition = "center";
            }
            });
        </script>
    </main>
        <script src="/resources/js/index.js"></script>
        <script src="/resources/js/imagenes.js"></script>
        <script src="/resources/js/template.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.js" defer></script>
        <script src="/resources/js/escritorio.js" defer type="module"></script>
</body>
</html>