<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Ruben Quiroz">
    <title>Escritorio</title>
<!-- link a stylos css -->
    <link rel="stylesheet" href="/resources/css/styles.css">
    <link rel="stylesheet" href="/resources/css/windows.css">
    <link rel="stylesheet" href="/resources/css/template.css">
    <link rel="dns-prefetch" href="//unpkg.com" />
    <link rel="dns-prefetch" href="//cdn.jsdelivr.net" />
    <link rel="stylesheet" href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css">
</head>
<body>
    <main>
            <div class="bg-cover bg-center h-screen relative overflow-hidden"  style="background-image: url('/resources/assets/images/Fondo1.png');">
            <div class="barra-superior">
                <!-- Contenido de la barra superior -->
                <div class="botones flex justify-start items-center">
                    <!-- <button><img class="h-20 w-20" src="/resources/assets/images/probart.png" width="20"
                            height="20"></button> -->
                </div>
                <div class="botones flex align-center px-2">
                    <span class="hora_actual px-2 text-2xl">00:00</span>

                     <!--Iconos de estado wifi, sonido, bateria -->
                     <button class="px-2">
                        <img src="https://img.icons8.com/ios-filled/20/ffffff/wifi.png" alt="WiFi" class="w-5 h-5">
                    </button>
                    <button class="px-2">
                          <img src="https://img.icons8.com/ios-filled/20/ffffff/speaker.png" alt="Sonido" class="w-5 h-5">
                    </button>
                    <button class="px-2">
                        <img src="https://img.icons8.com/ios-filled/20/ffffff/battery--v1.png" alt="Batería" class="w-5 h-5">
                    </button>
                    <button class="px-2">
                        <svg xmlns="http://www.w3.org/2000/svg"
                            class="  icon icon-tabler icon-tabler-user-star" width="28" height="28" viewBox="0 0 24 24"
                            stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round"
                            stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                            <path d="M6 21v-2a4 4 0 0 1 4 -4h1"></path>
                            <path
                                d="M17.8 20.817l-2.172 1.138a.392 .392 0 0 1 -.568 -.41l.415 -2.411l-1.757 -1.707a.389 .389 0 0 1 .217 -.665l2.428 -.352l1.086 -2.193a.392 .392 0 0 1 .702 0l1.086 2.193l2.428 .352a.39 .39 0 0 1 .217 .665l-1.757 1.707l.414 2.41a.39 .39 0 0 1 -.567 .411l-2.172 -1.138z">
                            </path>
                            <path d="M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0"></path>
                        </svg>
                    </button>
                    <button class="px-2 rounded-none focus:outline-none" id="calendar">
                    <!-- para evitar que al dar click sostenido se redondee el botón de color negro -->
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="28" height="28" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                            <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
                            <path d="M18 18m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0" />
                            <path d="M15 3v4" />
                            <path d="M7 3v4" />
                            <path d="M3 11h16" />
                            <path d="M18 16.496v1.504l1 1" />
                          </svg>
                    </button>
                    <button class="cerrarSesion px-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-logout" width="28"
                            height="28" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none"
                            stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                            <path d="M14 8v-2a2 2 0 0 0 -2 -2h-7a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h7a2 2 0 0 0 2 -2v-2">
                            </path>
                            <path d="M7 12h14l-3 -3m0 6l3 -3"></path>
                        </svg>
                    </button>
                </div>
            </div>
            <!-- Barra de tarea -->
<!-- Barra de tareas siempre abajo -->
<div class="flex justify-center">
    <div class="barra-tareas flex items-center space-x-2">

        <!-- Grupo Inicio -->
        <div class="relative">
            <!-- Botón tipo Inicio -->
            <button id="boton-inicio" class="button-barra-tareas">
                <img src="/resources/assets/images/probart.png" alt="Inicio" class="h-8 w-8">
            </button>

            <!-- Menú tipo Inicio pegado al lado del botón -->
<div id="menu-inicio" class="absolute left-0 bottom-full mb-2 bg-gray-900 bg-opacity-95 text-white rounded-lg shadow-lg p-3 z-50 w-[400px] hidden">
    <div class="grid grid-cols-2 gap-2">
        <!-- Columna 1: Apps -->
        <div class="flex flex-col space-y-1">
            <h3 class="text-base font-semibold mb-1">Aplicaciones</h3>
            <button class="app-launch flex items-center bg-gray-800 hover:bg-gray-700 p-1.5 rounded text-sm" data-app="antivirus">
                <img src="/resources/assets/images/antivirus.png" class="h-5 w-5 mr-2" />
                <span>Antivirus</span>
            </button>
            <button class="app-launch flex items-center bg-gray-800 hover:bg-gray-700 p-1.5 rounded text-sm" data-app="google">
                <img src="/resources/assets/images/cromo.png" class="h-5 w-5 mr-2" />
                <span>Google</span>
            </button>
            <button class="app-launch flex items-center bg-gray-800 hover:bg-gray-700 p-1.5 rounded text-sm" data-app="pac_man">
                <img src="/resources/assets/images/juego.png" class="h-5 w-5 mr-2" />
                <span>Pac Man</span>
            </button>
            <button class="app-launch flex items-center bg-gray-800 hover:bg-gray-700 p-1.5 rounded text-sm" data-app="temporisador">
                <img src="/resources/assets/images/temporizador.png" class="h-5 w-5 mr-2" />
                <span>Temporizador</span>
            </button>
            <button class="app-launch flex items-center bg-gray-800 hover:bg-gray-700 p-1.5 rounded text-sm" data-app="webadpp">
                <img src="/resources/assets/images/tiempo.png" class="h-5 w-5 mr-2" />
                <span>Tiempo</span>
            </button>
            <button class="app-launch flex items-center bg-gray-800 hover:bg-gray-700 p-1.5 rounded text-sm" data-app="spotify">
                <img src="/resources/assets/images/musica.png" class="h-5 w-5 mr-2" alt="Spotify">
                <span>Arvik Beats</span>
            </button>
                <button class="app-launch flex items-center bg-gray-800 hover:bg-gray-700 p-1.5 rounded text-sm" data-app="camara">
                <img src="/resources/assets/images/camera-solid 1.png" class="h-5 w-5 mr-2" alt="Spotify">
                <span>camara</span>
            </button>
        </div>
        <!-- Columna 2: Widgets -->
        <div class="flex flex-col space-y-1">
            <h3 class="text-base font-semibold mb-1">Widgets</h3>
            <div id="widgetContainer" class="flex flex-col space-y-1 text-sm"></div>
        </div>
    </div>
</div>

<!-- CSS animación -->
<style>
#menu-inicio.show {
    display: block !important;
    opacity: 1;
    transform: translateY(0);
    pointer-events: auto;
    z-index:200;
    position: absolute;
    
}

#menu-inicio {
    display: none;
    opacity: 0;
    transform: translateY(10px);
    pointer-events: none;
    transition: opacity 0.3s ease, transform 0.3s ease;
    z-index:200;
    position: absolute;
}
</style>
        <!-- Apps -->
        <button class="button-barra-tareas search_icon" >
        <div class="buscar">
            <img src="/resources/assets/images/buscador.png">
            </div>
        </button>
        <button class="button-barra-tareas terminal">
            <img src="/resources/assets/images/terminal-solid 1.png">
        </button>
        <button class="button-barra-tareas imagenes">
            <img src="/resources/assets/images/imagen (2).png">
        </button>
        <button class="button-barra-tareas ed_texto">
            <img src="/resources/assets/images/clipboard-regular 2.png">
        </button>
        <button class="button-barra-tareas video">
            <img src="/resources/assets/images/video-solid 1.png">
        </button>
        <button class="button-barra-tareas calculator">
            <img src="/resources/assets/images/calculator-solid 1.png">
        </button>
        <button class="button-barra-tareas paint tasks">
            <img src="/resources/assets/images/test_tasks_list_clipboard_todo_icon_191634 1.png">
        </button>
        <button class="button-barra-tareas explorer-files">
            <img src="/resources/assets/images/folder-regular 1.png">
        </button>
    </div>
</div>
</div>
            <!-- calendario -->
            <div class="calendario w-8/12 fixed top-0 right-0 bg-opacity-50 bg-transparent hidden">
                <style>
                [x-cloak] {
                    display: none;
                }
                </style>
                <div class="w-full min-h-screen flex justify-end items-start p-8 mt-16">
                    <div class="w-11/12 md:w-8/12 bg-purple-700 bg-opacity-95 rounded-xl shadow-xl p-6" x-data="app()" x-init="[initDate(), getNoOfDays()]" x-cloak>
                        <div class="flex items-center justify-between mb-4 text-white">
                            <div>
                                <span x-text="MONTH_NAMES[month]" class="text-2xl font-bold"></span>
                                <span x-text="year" class="ml-2 text-xl"></span>
                            </div>
                            <div class="flex space-x-2 items-center">
                                <button @click="month--; getNoOfDays()" :disabled="month == 0" class="bg-white text-purple-700 p-2 rounded-full hover:bg-purple-200 disabled:opacity-50">
                                    <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                                    </svg>
                                </button>
                                <button @click="month++; getNoOfDays()" :disabled="month == 11" class="bg-white text-purple-700 p-2 rounded-full hover:bg-purple-200 disabled:opacity-50">
                                    <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                                    </svg>
                                </button>
                                <button @click="$el.closest('.calendario').classList.add('hidden')" class="text-white text-xl font-bold hover:text-purple-200">✕</button>
                            </div>
                        </div>

                        <div class="grid grid-cols-7 text-center text-white font-semibold">
                            <template x-for="(day, index) in DAYS" :key="index">
                                <div class="py-2" x-text="day"></div>
                            </template>
                        </div>

                        <div class="grid grid-cols-7 gap-2 mt-2">
                            <template x-for="blankday in blankdays">
                                <div></div>
                            </template>
                            <template x-for="(date, dateIndex) in no_of_days" :key="dateIndex">
                                <div class="bg-white rounded-lg p-2 text-purple-700 relative">
                                    <div @click="showEventModal(date)"
                                        class="cursor-pointer hover:bg-purple-100 rounded-full w-8 h-8 flex items-center justify-center text-sm font-bold mx-auto"
                                        :class="{ 'bg-purple-700 text-white': isToday(date) }" x-text="date">
                                    </div>
                                    <template x-for="event in events.filter(e => e.event_date === new Date(year, month, date).toISOString().split('T')[0])">
                                        <div class="mt-1 text-xs px-1 py-0.5 rounded bg-purple-200 text-purple-900 flex justify-between items-center">
                                            <span x-text="event.event_title" class="truncate"></span>
                                            <div class="ml-2">
                                                <button class="text-xs text-red-500 hover:underline" @click="removeEvent(event)">Eliminar</button>
                                                <button class="text-xs text-blue-500 hover:underline ml-1" @click="editEvent(event)">Editar</button>
                                            </div>
                                        </div>
                                    </template>
                                </div>
                            </template>
                        </div>
                        <!-- Modal -->
                        <!-- Calendario -->
                        <div x-show.transition.opacity="openEventModal" class="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50">
                            <div class="bg-white rounded-lg shadow-lg w-full max-w-md p-6">
                                <h2 class="text-2xl font-semibold text-purple-700 mb-4">Detalles del Evento</h2>

                                <label class="block mb-2 text-sm font-medium text-gray-700">Título del evento</label>
                                <input x-model="event_title" class="w-full mb-4 p-2 border rounded" type="text">

                                <label class="block mb-2 text-sm font-medium text-gray-700">Fecha</label>
                                <input x-model="formatted_event_date" class="w-full mb-4 p-2 border rounded bg-gray-100" type="text" readonly>
                                <div class="text-right">
                                    <button @click="openEventModal = false" class="bg-gray-300 px-4 py-2 rounded mr-2">Cancelar</button>
                                    <button @click="addEvent()" class="bg-purple-700 text-white px-4 py-2 rounded">Guardar</button>
                                </div>
                            </div>
                        </div>  
                    </div>
                </div>
            </div>
             <!-- Crear ventanas Mobales para diferentes App -->
            <div id="windowsContainer"></div>
            <!-- /funciones del calendario-->
            <script>
                const MONTH_NAMES = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];
                const DAYS = ['Dom', 'Lun', 'Mar', 'Mié', 'Jue', 'Vie', 'Sáb'];

                function app() {
            return {
                month: '',
                year: '',
                no_of_days: [],
                blankdays: [],
                days: DAYS,
                events: [],
                event_title: '',
                event_date: '',
                openEventModal: false,
                editMode: false,
                editingEventIndex: null,

                get formatted_event_date() {
                    return this.event_date ? new Date(this.event_date).toLocaleDateString('es-ES', {
                        weekday: 'long',
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric'
                    }) : '';
                },

                initDate() {
                    let today = new Date();
                    this.month = today.getMonth();
                    this.year = today.getFullYear();
                    this.getNoOfDays();
                    this.loadEvents();
                },

                isToday(date) {
                    const today = new Date();
                    const d = new Date(this.year, this.month, date);
                    return today.toDateString() === d.toDateString();
                },

                showEventModal(date) {
                    this.openEventModal = true;
                    this.event_date = new Date(this.year, this.month, date).toISOString().split('T')[0]; // formato ISO
                    this.event_title = '';
                    this.editMode = false;
                    this.editingEventIndex = null;
                },

                addEvent() {
                    if (!this.event_title) return;

                    if (this.editMode && this.editingEventIndex !== null) {
                        this.events[this.editingEventIndex].event_title = this.event_title;
                    } else {
                        this.events.push({
                            event_date: this.event_date,
                            event_title: this.event_title
                        });
                    }

                    this.saveEvents();
                    this.resetModal();
                },

                removeEvent(event) {
                    this.events = this.events.filter(e => e !== event);
                    this.saveEvents();
                },

                editEvent(event) {
                    this.event_title = event.event_title;
                    this.event_date = event.event_date;
                    this.editMode = true;
                    this.openEventModal = true;
                    this.editingEventIndex = this.events.indexOf(event);
                },

                getNoOfDays() {
                    let daysInMonth = new Date(this.year, this.month + 1, 0).getDate();
                    let dayOfWeek = new Date(this.year, this.month).getDay();
                    this.blankdays = Array.from({ length: dayOfWeek }, (_, i) => i);
                    this.no_of_days = Array.from({ length: daysInMonth }, (_, i) => i + 1);
                },

                saveEvents() {
                    localStorage.setItem('calendar-events', JSON.stringify(this.events));
                },

                loadEvents() {
                    const saved = localStorage.getItem('calendar-events');
                    if (saved) {
                        this.events = JSON.parse(saved);
                    }
                },

                resetModal() {
                    this.event_title = '';
                    this.event_date = '';
                    this.openEventModal = false;
                    this.editMode = false;
                    this.editingEventIndex = null;
                }
            }
        }
            </script>
    
            <!-- //mostrar automáticamente un fondo personalizado (wallpaper) -->
            <script>
            document.addEventListener("DOMContentLoaded", function () {
            const wallpaper = localStorage.getItem("wallpaper");
            const bgCover = document.getElementsByClassName("bg-cover")[0];
            if (wallpaper && bgCover) {
                bgCover.style.backgroundImage = `url('${wallpaper}')`;
                bgCover.style.backgroundSize = "cover";
                bgCover.style.backgroundRepeat = "no-repeat";
                bgCover.style.backgroundPosition = "center";
            }
            });
            </script>
    </main>
    <!-- Menú contextual tipo Windows -->
<ul id="contextMenuEscritorio" class="hidden fixed bg-gray-800 text-white rounded shadow-lg z-50 p-2" style="min-width: 180px;">
  <!-- <li class="px-4 py-2 hover:bg-gray-700 cursor-pointer" onclick="verPropiedades()">🧾 Ver propiedades</li> -->
  <li onclick="verPropiedades()">Ver propiedades</li>
  <li onclick="eliminarIcono()">Eliminar ícono</li>
</ul>

<!-- Modal de propiedades -->
<div id="modalPropiedades" class="hidden fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50">
  <div class="bg-white text-black rounded-lg p-6 w-96 shadow-xl">
    <h2 class="text-xl font-bold mb-4">Propiedades del Escritorio</h2>
    <p>Resolución: <span id="resolucion"></span></p>
    <p>Color de fondo: <span id="colorFondo"></span></p>
    <p>Hora actual: <span id="horaPropiedad"></span></p>
    <div class="text-right mt-4">
      <button onclick="cerrarPropiedades()" class="bg-blue-600 text-white px-4 py-2 rounded">Cerrar</button>
    </div>
  </div>
</div>

        <script src="/resources/js/index.js"></script>
        <script src="/resources/js/imagenes.js"></script>
        <script src="/resources/js/template.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.js" defer></script>
        <script src="/resources/js/escritorio.js" defer type="module"></script>
        <script src="/resources/js/fullscreen.js"></script>
</body>
</html>